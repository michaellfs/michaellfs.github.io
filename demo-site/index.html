<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Demo Site</title>
    <meta name="description" content="" />
    <meta name="author" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- 
        Tealium Head script (utag.sync.js) should load up synchronously, as shown.
        It should be inside the <head> tag, as close to the top as possible, preferably 
            before any other page resources.
        The environment can be "dev", "qa" or "prod". We are loading up "qa" here.
    -->
    <script src="https://tags.tiqcdn.com/utag/latitudefs/main/qa/utag.sync.js"></script>
    <!-- End Tealium Head script -->

    <link
      href="http://fonts.googleapis.com/css?family=Raleway:400,300,600"
      rel="stylesheet"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="https://michaellfs.github.io/css/normalize.css"
    />
    <link
      rel="stylesheet"
      href="https://michaellfs.github.io/css/skeleton.css"
    />
  </head>
  <body>
    <!-- 
        Datalayer should be embedded on the page, and populated by server-side values.
        It can appear in either the <head> or <body> section, as long as it is before the utag.js (async) tag.
    -->
    <script type="text/javascript">
      var digitalData = {
        page: {
          pagetype: "information-page",
          site: "demo-site",
          sitecountry: "au",
          sitesection: "home",
          sitesubsection: "",
          pagetitle: "demo-home-page"
        },
        product: { productId: ["DEMO001"] }
      };

      function flattenData(data, prefix, result) {
        prefix = prefix || "";
        result = result || {};
        for (var key in data) {
          var lowerCaseKey = key.toLowerCase();

          if (typeof data[key] !== "object" || data[key] instanceof Array) {
            result[prefix + lowerCaseKey] = data[key];
          } else {
            flattenData(data[key], prefix + lowerCaseKey + "_", result);
          }
        }
        return result;
      }

      var utag_data = flattenData(digitalData);
      /* This converts the Latitude-specific nested object (digitalData) into the Tealium-specific flat object (utag_data) similar to the following
        var utag_data = {
            page_pagetype: "information-page",
            page_site: "demo-site",
            page_sitecountry: "au",
            page_sitesection: "home",
            page_sitesubsection: "",
            page_pagetitle: "demo-home-page",
            product_productid: ["DEMO001"]
        };
      */
    </script>
    <!-- End Datalayer script -->

    <!-- Tealium Body script (utag.js) can load up asynchronously, as shown. 
    The environment can be "dev", "qa" or "prod". We are loading up "qa" here. -->
    <script type="text/javascript">
      (function(a, b, c, d) {
        a = "https://tags.tiqcdn.com/utag/latitudefs/main/qa/utag.js";
        b = document;
        c = "script";
        d = b.createElement(c);
        d.src = a;
        d.type = "text/java" + c;
        d.async = true;
        a = b.getElementsByTagName(c)[0];
        a.parentNode.insertBefore(d, a);
      })();
    </script>

    <div class="container">
      <div class="row">
        <div class="one-half column" style="margin-top: 25%">
          <h4>LFS Tealium - Getting Started</h4>
          <p>
            This is the demo homepage, showing an example of the minimum
            LFS-approved implementation. Right-click and "View Page Source" for details.
          </p>

          <p>In the console:
            <ul>
              <li>
                Type <code>digitalData</code> to print the datalayer of this page. Visit 
                <a href="https://di.latitudefinancial.com/wiki/display/DIG/1.+Analytics+Data+Layer+Schema">Analytics Datalayer Schema</a>
                to see all (optional) elements.
              </li>
              <li>
                Type <code>utag.view()</code> to trigger a page-load call in Tealium. These are used on page-load, 
                for both real (static sites) and virtual (E.g. Single Page Applications - SPAs). 
              </li>
              <li>
                Type <code>utag.link(flattenData({event: {category: "lightbox", action: "click", label: 
                "more info", location: "footer"}}))</code> to trigger a link call in Tealium. These are 
                typically used to track events that are not page-loads. Examples include some button 
                clicks, lightboxes, and similar interactions. Visit the
                <a href="https://di.latitudefinancial.com/wiki/display/DIG/Rules+for+datalayer+eventObject+consistency">Event Object</a> 
                page for more info
              </li>
            </ul>
          </p>
          
        </div>
      </div>
    </div>
  </body>
</html>
