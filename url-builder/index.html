<html>
    <head>
        <link rel="stylesheet" href="../css/normalize.css">
        <link rel="stylesheet" href="../css/skeleton.css">
        <script>
            function createUrl() {
                formValid = true;
                ["landingurl","medium","source","campaign","product","audience","creative"].forEach(name => {
                    document.getElementById(name).style.borderColor = "";
                    val = document.getElementById(name).value;
                    if (!val) {
                        document.getElementById(name).style.borderColor = "red";
                        formValid = false;
                    }
                    document.getElementById(name).onchange = hideResultDiv;
                });

                if (formValid) {
                    url = document.getElementById('landingurl').value;
                    medium = document.getElementById('medium').value;
                    source = document.getElementById('source').value;
                    campaign = document.getElementById('campaign').value.replace(/ /g, "-");
                    product = document.getElementById('product').value;
                    audience = document.getElementById('audience').value;
                    creative = document.getElementById('creative').value.replace(/ /g, "-");
                    context = document.getElementById('context').value.replace(/ /g, "-");

                    gemid1 = "gemid1="+[medium,source,campaign,product,audience,creative].join(':');
                    utmparams = ["utm_medium="+medium, "utm_source="+source, "utm_campaign="+campaign, "utm_product="+product, "utm_audience="+audience, "utm_creative="+creative].join('&');
                    if (context) {
                        gemid1+=":"+context;
                        utmparams+="&utm_content="+context
                    }
                    document.getElementById('result').innerHTML = [url,"?",gemid1,"&",utmparams].join('');
                    document.getElementById('resultDiv').style.display = "block";
                }
                return false;
            }

            function hideResultDiv() {
                document.getElementById('resultDiv').style.display = "none";
            }
            function copyURL() {
                resultField = document.querySelector("#copyResult");
                var copyText = document.querySelector("#result");
                copyText.select();
                if (document.execCommand("copy")) {
                    resultField.style.visibility = "visible";
                    setTimeout(() => resultField.style.visibility = "hidden", 3000)
                }


            }
        </script>
    </head>
    <body>
        <div class="container">
        <h1>LFS - Digital Analytics - URL Builder</h1>
        <div class="row">
            <div class="two columns">
                Landing Page URL <span style="color: darkred">*</span>
            </div>
            <div class="ten columns">
                <input type="text" id="landingurl" placeholder="https://lfs-domain.com" class="u-full-width" maxlength="20" />
            </div>
        </div>
        <div class="row">
            <div class="five columns">
                    <div class="row">
                        <div class="three columns">
                                Medium <span style="color: darkred">*</span>
                        </div>
                        <div class="nine columns">
                            <select id="medium" class="u-full-width">
                                <option value="">Select...</option>
                                <option>organic</option>
                                <option>paid</option>
                                <option>display</option>
                                <option>social</option>
                                <option>email</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="three columns">
                            Source <span style="color: darkred">*</span>
                        </div>
                        <div class="nine columns">
                            <select id="source" class="u-full-width">
                                <option value="">Select...</option>
                                <option>google</option>
                                <option>yahoo</option>
                                <option>bing</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="three columns">
                            Campaign <span style="color: darkred">*</span>
                        </div>
                        <div class="nine columns">
                            <input type="text" id="campaign" placeholder="test-campaign" class="u-full-width" maxlength="20" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="three columns">
                            Product <span style="color: darkred">*</span>
                        </div>
                        <div class="nine columns">
                            <select id="product" class="u-full-width">
                                <option value="">Select...</option>
                                <option>personal-loans-au</option>
                                <option>personal-loans-gem</option>
                                <option>personal-loans-kiwi</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="three columns">
                            Audience <span style="color: darkred">*</span>
                        </div>
                        <div class="nine columns">
                            <select id="audience" class="u-full-width">
                                <option value="">Select...</option>
                                <option>prospecting</option>
                                <option>retargeting</option>
                                <option>awareness</option>
                                <option>consideration</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="three columns" >
                            Creative <span style="color: darkred" >*</span>
                        </div>
                        <div class="nine columns" >
                            <input type="text" id="creative" placeholder="test-creative" class="u-full-width" maxlength="20" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="three columns">
                            Context
                        </div>
                        <div class="nine columns">
                            <input type="text" id="context" placeholder="test-context" class="u-full-width" maxlength="20" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="three columns">
                            
                        </div>
                        <div class="nine columns">
                            <input type="submit" value="Create URL" onclick="createUrl()" />
                        </div>
                    </div>
                </div>
                <div class="five columns" id="resultDiv" style="display: none;">
                    <div>Result:</div>
                    <div>
                        <textarea id="result"  class="u-full-width" style="height: 200px"></textarea>
                        <div class="u-pull-right">
                            <input type="button" value="Copy URL to clipboard" onclick="copyURL()" />
                            <span id="copyResult" style="visibility: hidden">URL copied!</span>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    </div>
    </body>
</html>